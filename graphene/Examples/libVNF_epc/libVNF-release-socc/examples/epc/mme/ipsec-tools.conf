# Configuration for 169.254.9.9
# Flush the SAD and SPD
flush;
spdflush;

# Attention: Use this keys only for testing purposes!
# Generate your own keys!

# ESP SAs using 192 bit long keys (168 + 24 parity)
add 169.254.9.10 169.254.9.9 esp 10 -m tunnel -u 10 -E rijndael-cbc 0xABABABABABABABABABABABABABABABAB -A hmac-sha1 0xC1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1;
add 169.254.9.10 169.254.9.9 esp 11 -m tunnel -u 11 -E rijndael-cbc 0xABABABABABABABABABABABABABABABAB -A hmac-sha1 0xC1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1;
add 169.254.9.10 169.254.9.9 esp 12 -m tunnel -u 12 -E rijndael-cbc 0xABABABABABABABABABABABABABABABAB -A hmac-sha1 0xC1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1;
add 169.254.9.10 169.254.9.9 esp 13 -m tunnel -u 13 -E rijndael-cbc 0xABABABABABABABABABABABABABABABAB -A hmac-sha1 0xC1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1;
add 169.254.9.10 169.254.9.9 esp 14 -m tunnel -u 14 -E rijndael-cbc 0xABABABABABABABABABABABABABABABAB -A hmac-sha1 0xC1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1;
add 169.254.9.10 169.254.9.9 esp 15 -m tunnel -u 15 -E rijndael-cbc 0xABABABABABABABABABABABABABABABAB -A hmac-sha1 0xC1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1;
add 169.254.9.10 169.254.9.9 esp 16 -m tunnel -u 16 -E rijndael-cbc 0xABABABABABABABABABABABABABABABAB -A hmac-sha1 0xC1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1;
add 169.254.9.10 169.254.9.9 esp 17 -m tunnel -u 17 -E rijndael-cbc 0xABABABABABABABABABABABABABABABAB -A hmac-sha1 0xC1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1;
add 169.254.9.10 169.254.9.9 esp 18 -m tunnel -u 18 -E rijndael-cbc 0xABABABABABABABABABABABABABABABAB -A hmac-sha1 0xC1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1;
add 169.254.9.10 169.254.9.9 esp 19 -m tunnel -u 19 -E rijndael-cbc 0xABABABABABABABABABABABABABABABAB -A hmac-sha1 0xC1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1;

add 169.254.9.9[4500] 169.254.9.10[14509] esp-udp 60 -m tunnel -u 60 -E rijndael-cbc 0x12121212121212121212121212121212 -A hmac-sha1 0xB5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5;
add 169.254.9.9[4501] 169.254.9.10[24508] esp-udp 61 -m tunnel -u 61 -E rijndael-cbc 0x12121212121212121212121212121212 -A hmac-sha1 0xB5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5;
add 169.254.9.9[4502] 169.254.9.10[14507] esp-udp 62 -m tunnel -u 62 -E rijndael-cbc 0x12121212121212121212121212121212 -A hmac-sha1 0xB5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5;
add 169.254.9.9[4503] 169.254.9.10[24506] esp-udp 63 -m tunnel -u 63 -E rijndael-cbc 0x12121212121212121212121212121212 -A hmac-sha1 0xB5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5;
add 169.254.9.9[4504] 169.254.9.10[14505] esp-udp 64 -m tunnel -u 64 -E rijndael-cbc 0x12121212121212121212121212121212 -A hmac-sha1 0xB5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5;
add 169.254.9.9[4505] 169.254.9.10[24504] esp-udp 65 -m tunnel -u 65 -E rijndael-cbc 0x12121212121212121212121212121212 -A hmac-sha1 0xB5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5;
add 169.254.9.9[4506] 169.254.9.10[14503] esp-udp 66 -m tunnel -u 66 -E rijndael-cbc 0x12121212121212121212121212121212 -A hmac-sha1 0xB5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5;
add 169.254.9.9[4507] 169.254.9.10[24502] esp-udp 67 -m tunnel -u 67 -E rijndael-cbc 0x12121212121212121212121212121212 -A hmac-sha1 0xB5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5;
add 169.254.9.9[4508] 169.254.9.10[14501] esp-udp 68 -m tunnel -u 68 -E rijndael-cbc 0x12121212121212121212121212121212 -A hmac-sha1 0xB5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5;
add 169.254.9.9[4509] 169.254.9.10[24500] esp-udp 69 -m tunnel -u 69 -E rijndael-cbc 0x12121212121212121212121212121212 -A hmac-sha1 0xB5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5B5;


# Security policies
spdadd 169.254.9.10/32 169.254.9.9/32[6000] any -P in  ipsec esp/tunnel/169.254.9.10-169.254.9.9/unique:10;
spdadd 169.254.9.10/32 169.254.9.9/32[6001] any -P in  ipsec esp/tunnel/169.254.9.10-169.254.9.9/unique:11;
spdadd 169.254.9.10/32 169.254.9.9/32[6002] any -P in  ipsec esp/tunnel/169.254.9.10-169.254.9.9/unique:12;
spdadd 169.254.9.10/32 169.254.9.9/32[6003] any -P in  ipsec esp/tunnel/169.254.9.10-169.254.9.9/unique:13;
spdadd 169.254.9.10/32 169.254.9.9/32[6004] any -P in  ipsec esp/tunnel/169.254.9.10-169.254.9.9/unique:14;
spdadd 169.254.9.10/32 169.254.9.9/32[6005] any -P in  ipsec esp/tunnel/169.254.9.10-169.254.9.9/unique:15;
spdadd 169.254.9.10/32 169.254.9.9/32[6006] any -P in  ipsec esp/tunnel/169.254.9.10-169.254.9.9/unique:16;
spdadd 169.254.9.10/32 169.254.9.9/32[6007] any -P in  ipsec esp/tunnel/169.254.9.10-169.254.9.9/unique:17;
spdadd 169.254.9.10/32 169.254.9.9/32[6008] any -P in  ipsec esp/tunnel/169.254.9.10-169.254.9.9/unique:18;
spdadd 169.254.9.10/32 169.254.9.9/32[6009] any -P in  ipsec esp/tunnel/169.254.9.10-169.254.9.9/unique:19;

spdadd 169.254.9.9/32[6000] 169.254.9.10/32 any -P out ipsec esp/tunnel/169.254.9.9[4500]-169.254.9.10[14509]/unique:60;
spdadd 169.254.9.9/32[6001] 169.254.9.10/32 any -P out ipsec esp/tunnel/169.254.9.9[4501]-169.254.9.10[24508]/unique:61;
spdadd 169.254.9.9/32[6002] 169.254.9.10/32 any -P out ipsec esp/tunnel/169.254.9.9[4502]-169.254.9.10[14507]/unique:62;
spdadd 169.254.9.9/32[6003] 169.254.9.10/32 any -P out ipsec esp/tunnel/169.254.9.9[4503]-169.254.9.10[24506]/unique:63;
spdadd 169.254.9.9/32[6004] 169.254.9.10/32 any -P out ipsec esp/tunnel/169.254.9.9[4504]-169.254.9.10[14505]/unique:64;
spdadd 169.254.9.9/32[6005] 169.254.9.10/32 any -P out ipsec esp/tunnel/169.254.9.9[4505]-169.254.9.10[24504]/unique:65;
spdadd 169.254.9.9/32[6006] 169.254.9.10/32 any -P out ipsec esp/tunnel/169.254.9.9[4506]-169.254.9.10[14503]/unique:66;
spdadd 169.254.9.9/32[6007] 169.254.9.10/32 any -P out ipsec esp/tunnel/169.254.9.9[4507]-169.254.9.10[24502]/unique:67;
spdadd 169.254.9.9/32[6008] 169.254.9.10/32 any -P out ipsec esp/tunnel/169.254.9.9[4508]-169.254.9.10[14501]/unique:68;
spdadd 169.254.9.9/32[6009] 169.254.9.10/32 any -P out ipsec esp/tunnel/169.254.9.9[4509]-169.254.9.10[24500]/unique:69;
